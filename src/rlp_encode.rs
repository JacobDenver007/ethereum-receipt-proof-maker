use rlp::RlpStream;
use crate::types::{
    Bytes,
    Result,
    Receipt
};

pub fn rlp_encode_receipt(receipt: &Receipt) -> Result<Bytes> {
    let mut rlp_stream = RlpStream::new();
    rlp_stream.append(receipt);
    Ok(rlp_stream.out())
}

#[cfg(test)]
mod tests {
    use super::*;
    use crate::test_utils::{
        get_expected_receipt
    };

    fn get_rlp_encoded_receipt() -> Bytes {
        vec![249, 1, 197, 49, 131, 120, 240, 40, 185, 1, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 248, 187, 248, 185, 148, 6, 1, 44, 140, 249, 123, 234, 213, 222, 174, 35, 112, 112, 249, 88, 127, 142, 122, 38, 109, 225, 160, 36, 30, 160, 60, 162, 2, 81, 128, 80, 132, 210, 125, 68, 64, 55, 28, 52, 160, 184, 95, 241, 8, 246, 187, 86, 17, 36, 143, 115, 129, 139, 128, 184, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 34, 209, 163, 42, 11, 229, 31, 113, 112, 47, 143, 100, 197, 110, 81, 199, 86, 11, 47, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 88, 59, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 86, 226, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 125, 165, 53]
    }

    #[test]
    fn should_rlp_encode_receipt() {
        let receipt = get_expected_receipt();
        let result = rlp_encode_receipt(&receipt)
            .unwrap();
        println!("{:?}", result);
        // FIXME: Assertions!
    }
}
